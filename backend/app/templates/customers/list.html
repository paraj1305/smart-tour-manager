{% extends "layout.html" %}

{% block content %}
<section class="content-header px-1">
    <div class="container-fluid d-flex justify-content-between align-items-center">
        <h1>Customers</h1>

        <a href="{{ url_for('customer_create') }}" class="btn btn-submit">
            Add Customer
        </a>
    </div>
    <hr>
</section>

<section class="content">
    <div class="container-fluid py-4">

        <table id="customerTable"
               class="table table-striped table-bordered"
               style="width:100%">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Phone</th>
                    <th>Email</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<link rel="stylesheet"
      href="{{ url_for('static', path='assets/plugins/datatables-responsive/css/jquery.dataTables.min.css') }}" />

<script src="{{ url_for('static', path='assets/plugins/datatables/jquery-3.6.0.min.js') }}"></script>
<script src="{{ url_for('static', path='assets/plugins/datatables/jquery.dataTables.min.js') }}"></script>

<script>
$(document).ready(function () {

  const table = $('#customerTable').DataTable({
    processing: true,
    serverSide: false,
    ajax: "{{ url_for('customers_datatable') }}",
    columns: [
      { data: "name" },
      { data: "phone" },
      { data: "email" },
      { data: "actions" },
    ],
    language: {
      searchPlaceholder: "Search customer, phone, email...",
      search: ""
    },
  });

  // Delete confirmation
  $(document).on("click", ".confirm-customer-delete", function (e) {
    e.preventDefault();
    confirmDelete(
            $(this).data('route'),
            'Are you sure you want to delete this customer?',
            'POST',
            table
        );
  });

});
</script>
{% endblock %}
