<div class="tour-packages-card">
    <div class="tour-packages-list">

        {% if tours %}
        {% for tour in tours %}
        <div class="tour-packages-item">

            <div class="tour-card">

                {# -------- COVER IMAGE -------- #}
                {% set cover_img = tour.gallery_images | selectattr("image_type", "equalto", "cover") | list %}

                <div class="tour-cover">
                    {% if cover_img %}
                    <img src="{{ url_for('static', path=cover_img[0].image_path) }}" alt="cover">
                    {% else %}
                    <div class="no-image">No Image</div>
                    {% endif %}

                    <span class="status-badge {{ tour.status }}">
                        {{ tour.status|capitalize }}
                    </span>
                </div>

                <div class="tour-body">

                    <h5 class="tour-title">{{ tour.title }}</h5>

                    <div class="tour-meta">
                        <span>üìç {{ tour.city }}, {{ tour.country }}</span>
                        <span class="price">{{tour.currency}} {{ tour.price }}</span>
                    </div>

                    {# -------- GALLERY -------- #}
                    {% set gallery_imgs = tour.gallery_images | selectattr("image_type", "equalto", "gallery") | list %}
                    {% if gallery_imgs %}
                    <div class="tour-gallery">
                        {% for img in gallery_imgs[:5] %}
                        <img src="{{ url_for('static', path=img.image_path) }}" class="gallery-thumb"
                            data-bs-toggle="modal" data-bs-target="#galleryModal"
                            data-img="{{ url_for('static', path=img.image_path) }}">
                        {% endfor %}
                        {% if gallery_imgs|length > 5 %}
                        <span class="more-count">+{{ gallery_imgs|length - 5 }}</span>
                        {% endif %}
                    </div>
                    {% endif %}

                    {# -------- ACTIONS -------- #}
                    <div class="tour-actions">
                        <a href="{{ url_for('tour_package_edit_page', package_id=tour.id) }}"
                            class="btn btn-default btn-xs">
                            Edit
                        </a>

                        <a href="javascript:void(0)" class="confirm-tour-delete btn btn-sm btn-cancel"
                            data-route="{{ request.url_for('tour_package_delete', package_id=tour.id) }}">
                            Delete
                        </a>
                        <a href="{{ url_for('tour_package_availability_page', package_id=tour.id) }}"
                        class="btn btn-submit">
                        Availability
                        </a>
                        <form method="post" action="{{ url_for('autofill_booking_create_page') }}">
                            <input type="hidden" name="package_id" value="{{ tour.id }}">

                            {% if travel_date %}
                                <input type="hidden" name="travel_date" value="{{ travel_date }}">
                            {% endif %}

                            <button type="submit" class="btn btn-submit">Book Package</button>
                        </form>


                    </div>

                </div>


            </div>

        </div>
        {% endfor %}
        <div class="modal fade" id="availabilityModal" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered modal-md">
                <div class="modal-content availability-modal">

                    <div class="modal-header text-white">
                        <h5 class="modal-title" id="availabilityTitle">Check Availability</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                    </div>

                    <div class="modal-body text-center">
                        <input type="text" id="availabilityCalendar" class="form-control">
                    </div>

                </div>
            </div>
        </div>

        <form id="autoBookingForm"
            method="post"
            action="{{ url_for('autofill_booking_create_page') }}"
            style="display:none;">

            <input type="hidden" name="package_id" id="auto_package_id">
            <input type="hidden" name="travel_date" id="auto_travel_date">

        </form>

    </div>

        {% else %}
        <div class="col-12 text-center py-5">
            <h5>No tour packages found</h5>
        </div>
        {% endif %}

    </div>
</div>